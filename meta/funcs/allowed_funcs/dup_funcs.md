Объявление:

    int dup(int fildes);
    
    int dup2(int fildes, int fildes2);

Header files:

    <unistd.h>

ОПИСАНИЕ
dup() дублирует существующий дескриптор объекта и возвращает его значение вызывающему процессу (fildes2 = dup(fildes)).  Аргумент fildes - это небольшой неотрицательный целочисленный индекс в таблице дескрипторов каждого процесса.  Значение должно быть меньше размера таблицы, который возвращается функцией getdtablesize(2).  Новый дескриптор, возвращаемый этим вызовом, является самым младшим по номеру дескриптором, который в данный момент не используется процессом.

Объект, на который ссылается дескриптор, никак не различает fildes и fildes2.  Таким образом, если fildes2 и fildes являются дублирующими ссылками на открытый файл, вызовы read(2), write(2) и lseek(2) перемещают один указатель в файле, а режим добавления, неблокирующий ввод/вывод и опции асинхронного ввода/вывода разделяются между ссылками.  Если требуется отдельный указатель на файл, необходимо получить другую объектную ссылку на файл, выполнив дополнительный вызов open(2).  Флаг close-on-exec нового дескриптора файла не установлен.

В dup2() указывается значение нового дескриптора - fildes2.  Если fildes и fildes2 равны, то dup2() просто возвращает fildes2; никаких других изменений в существующий дескриптор не вносится.  В противном случае, если дескриптор fildes2 уже используется, он сначала деаллоцируется, как если бы сначала был выполнен вызов close(2).



ВОЗВРАЩАЕМЫЕ ЗНАЧЕНИЯ
При успешном завершении возвращается новый дескриптор файла.  В противном случае возвращается значение -1 и устанавливается глобальная целочисленная переменная errno, указывающая на ошибку.

